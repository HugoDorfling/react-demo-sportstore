(this.webpackJsonpsportstore=this.webpackJsonpsportstore||[]).push([[4],{107:function(e,t,a){"use strict";a.r(t);var r=a(2),n=a(6),c=a(4),o=a(3),l=a(0),i=a.n(l),s=a(105),u=a(85),p=a(17),d=a(95),m=a(88),b=a.n(m);function f(){var e=Object(d.a)(["\n  query($id: ID!) {\n    product(id: $id) {\n      id\n      name\n      description\n      category\n      price\n    }\n  }\n"]);return f=function(){return e},e}function h(){var e=Object(d.a)(["\n  query($page: Int, $pageSize: Int, $sort: String) {\n    products {\n      totalSize\n      products(page: $page, pageSize: $pageSize, sort: $sort) {\n        id\n        name\n        category\n        price\n      }\n    }\n  }\n"]);return h=function(){return e},e}function g(){var e=Object(d.a)(["\n  query($onlyShipped: Boolean, $page: Int, $pageSize: Int, $sort: String) {\n    orders(onlyUnshipped: $onlyShipped) {\n      totalSize\n      orders(page: $page, pageSize: $pageSize, sort: $sort) {\n        id\n        name\n        email\n        shipped\n        products {\n          quantity\n          product {\n            price\n          }\n        }\n      }\n    }\n  }\n"]);return g=function(){return e},e}var E=b()(g()),v=b()(h()),O=b()(f()),S=function(e){Object(c.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(r.a)(this,a);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).calcTotal=function(e){return e.reduce((function(e,t){return e+t.quantity*t.product.price}),0).toFixed(2)},e.getShipping=function(e){return e.shipped?i.a.createElement("i",{className:"fa fa-shipping-fast text-success"}):i.a.createElement("i",{className:"fa fa-exclamation-circle text-danger"})},e.render=function(){return i.a.createElement("tr",null,i.a.createElement("td",null,e.props.order.id),i.a.createElement("td",null,e.props.order.name),i.a.createElement("td",null,e.props.order.email),i.a.createElement("td",{className:"text-right"},"$",e.calcTotal(e.props.order.products)),i.a.createElement("td",{className:"text-center"},i.a.createElement("button",{className:"btn btn-sm btn-block bg-muted",onClick:e.props.toggleShipped},e.getShipping(e.props.order),i.a.createElement("span",null,e.props.order.shipped?" Shipped":" Pending"))))},e}return a}(l.Component),j=a(29),y=function(e){Object(c.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(r.a)(this,a);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).render=function(){return i.a.createElement("div",null,i.a.createElement("h4",{className:"bg-info text-white text-center p-2"},e.props.totalSize," Orders"),i.a.createElement(j.a,Object.assign({keys:["ID","Name"]},e.props)),i.a.createElement("table",{className:"table table-sm table-striped"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"ID"),i.a.createElement("th",null,"Name"),i.a.createElement("th",null,"Email"),i.a.createElement("th",{className:"text-right"},"Total"),i.a.createElement("th",{className:"text-center"},"Shipped"))),i.a.createElement("tbody",null,e.props.orders.map((function(t){return i.a.createElement(S,{key:t.id,order:t,toggleShipped:function(){return e.props.toggleShipped(t.id,!t.shipped)}})})))))},e}return a}(l.Component);function N(){var e=Object(d.a)(["\n  mutation($id: ID!) {\n    deleteProduct(id: $id) {\n      id\n    }\n  }\n"]);return N=function(){return e},e}function x(){var e=Object(d.a)(["\n  mutation($product: productUpdate) {\n    updateProduct(product: $product) {\n      id\n      name\n      category\n      description\n      price\n    }\n  }\n"]);return x=function(){return e},e}function z(){var e=Object(d.a)(["\n  mutation($product: productStore) {\n    storeProduct(product: $product) {\n      id\n      name\n      category\n      description\n      price\n    }\n  }\n"]);return z=function(){return e},e}function $(){var e=Object(d.a)(["\n  mutation($id: ID!, $shipped: Boolean!) {\n    shipOrder(id: $id, shipped: $shipped) {\n      id\n      shipped\n    }\n  }\n"]);return $=function(){return e},e}var w=b()($()),C=b()(z()),P=b()(x()),k=b()(N()),A={onlyShipped:!1,page:1,pageSize:10,sort:"id"},T=Object(u.compose)(Object(u.graphql)(E,{options:function(e){return{variables:A}},props:function(e){var t=e.data,a=t.loading,r=t.orders,n=t.refetch;return{totalSize:a?0:r.totalSize,orders:a?[]:r.orders,currentPage:A.page,pageCount:a?0:Math.ceil(r.totalSize/A.pageSize),navigateToPage:function(e){A.page=Number(e),n(A)},pageSize:A.pageSize,setPageSize:function(e){A.pageSize=Number(e),n(A)},sortKey:A.sort,setSortProperty:function(e){A.sort=e,n(A)}}}}),Object(u.graphql)(w,{props:function(e){var t=e.mutate;return{toggleShipped:function(e,a){return t({variables:{id:e,shipped:a}})}}}}))(y),q=a(81),M=a(75),I=a(78),D=a(26),R=a(5),B=a(76),L=function(e){Object(c.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(r.a)(this,a);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).render=function(){return i.a.createElement("tr",null,i.a.createElement("td",null,e.props.product.id),i.a.createElement("td",null,e.props.product.name),i.a.createElement("td",null,e.props.product.category),i.a.createElement("td",{className:"text-right"},"$",e.props.product.price.toFixed(2)),i.a.createElement("td",{className:"text-center"},i.a.createElement("button",{className:"btn btn-sm btn-danger mx-1",onClick:function(){return e.props.deleteProduct(e.props.product.id)}},"Delete ",i.a.createElement("i",{class:"fas fa-backspace"})),i.a.createElement(B.a,{to:"/admin/products/".concat(e.props.product.id),className:"btn btn-sm btn-warning"},"Edit ",i.a.createElement("i",{class:"fas fa-edit"}))))},e}return a}(l.Component),Q=function(e){Object(c.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(r.a)(this,a);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).render=function(){return i.a.createElement("div",null,i.a.createElement("h4",{className:"bg-info text-white text-center p-2"},e.props.totalSize," Products"),i.a.createElement(j.a,Object.assign({keys:["ID","Name","Category"]},e.props)),i.a.createElement("table",{className:"table table-sm table-striped"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"ID"),i.a.createElement("th",null,"Name"),i.a.createElement("th",null,"Category"),i.a.createElement("th",{className:"text-right"},"Price"),i.a.createElement("th",{className:"text-center"}))),i.a.createElement("tbody",null,e.props.products.map((function(t){return i.a.createElement(L,{key:t.id,product:t,deleteProduct:e.props.deleteProduct})})))),i.a.createElement("div",{className:"text-center"},i.a.createElement(B.a,{to:"/admin/products/create",className:"btn btn-primary create-product-button"},"Create Product ",i.a.createElement("i",{class:"far fa-plus-square"}))))},e}return a}(l.Component),U={page:1,pageSize:10,sort:"id"},F=Object(u.compose)(Object(u.graphql)(v,{options:function(e){return{variables:U}},props:function(e){var t=e.data,a=t.loading,r=t.products,n=t.refetch;return{totalSize:a?0:r.totalSize,products:a?[]:r.products,currentPage:U.page,pageCount:a?0:Math.ceil(r.totalSize/U.pageSize),navigateToPage:function(e){U.page=Number(e),n(U)},pageSize:U.pageSize,setPageSize:function(e){U.pageSize=Number(e),n(U)},sortKey:U.sort,setSortProperty:function(e){U.sort=e,n(U)}}}}),Object(u.graphql)(k,{options:{update:function(e,t){var a=t.data.deleteProduct.id,r={query:v,variables:U},n=e.readQuery(r);n.products.products=n.products.products.filter((function(e){return e.id!==a})),n.products.totalSize=n.products.totalSize-1,e.writeQuery(Object(R.a)(Object(R.a)({},r),{},{data:n}))}},props:function(e){var t=e.mutate;return{deleteProduct:function(e){return t({variables:{id:e}})}}}}))(Q),J=a(15),K=a(28),V=function(e){Object(c.a)(a,e);var t=Object(o.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).navigate=function(){return n.props.history.push("/admin/products")},n.render=function(){return i.a.createElement("div",{className:"container-fluid"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col bg-dark text-white"},i.a.createElement("div",{className:"navbar-brand"},"SPORTS STORE"))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col m-2"},i.a.createElement(u.Mutation,{mutation:n.mutation},(function(e,t){var a=t.client;return i.a.createElement(K.a,{formModel:n.formModel,defaultAttrs:n.defaultAttrs,submitCallback:function(t){e({variables:{product:Object(R.a)(Object(R.a)({},t),{},{price:Number(t.price)})}}),"edit"!==n.props.mode&&a.resetStore(),n.navigate()},cancelCallback:n.navigate,submitText:"Save",cancelText:"Cancel"})})))))},n.defaultAttrs={type:"text",required:!0},n.formModel=[{label:"Name"},{label:"Description"},{label:"Category"},{label:"Price",attrs:{type:"number"}}],n.mutation=C,"edit"===n.props.mode&&(n.mutation=P,n.formModel=[{label:"Id",attrs:{disabled:!0}}].concat(Object(J.a)(n.formModel)).map((function(e){return Object(R.a)(Object(R.a)({},e),{},{attrs:Object(R.a)(Object(R.a)({},e.attrs),{},{defaultValue:n.props.product[e.label.toLowerCase()]})})}))),n}return a}(l.Component),G=function(e){Object(c.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(r.a)(this,a);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).render=function(){return i.a.createElement(u.Query,{query:O,variables:{id:e.props.match.params.id}},(function(t){var a=t.loading,r=t.data;return a?null:i.a.createElement(V,Object.assign({},e.props,{product:r.product,mode:"edit"}))}))},e}return a}(l.Component),H=a(80),W=a(36),X=function(e){return function(t){Object(c.a)(n,t);var a=Object(o.a)(n);function n(){var t;Object(r.a)(this,n);for(var c=arguments.length,o=new Array(c),l=0;l<c;l++)o[l]=arguments[l];return(t=a.call.apply(a,[this].concat(o))).render=function(){return i.a.createElement(W.a.Consumer,null,(function(a){return i.a.createElement(e,Object.assign({},t.props,a))}))},t}return n}(l.Component)},Y=Object(H.a)(X(function(e){Object(c.a)(a,e);var t=Object(o.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).authenticate=function(e){n.props.authenticate(e).catch((function(e){return n.setState({errorMessage:e.message})})).then(n.props.history.push("/admin"))},n.render=function(){return i.a.createElement("div",{className:"container-fluid"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col bg-dark text-white"},i.a.createElement("div",{className:"navbar-brand"},"SPORTS STORE"))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col m-2"},null!=n.state.errorMessage&&i.a.createElement("h4",{className:"bg-danger text-center text-white m-1 p-2"},n.state.errorMessage),i.a.createElement(K.a,{formModel:n.formModel,defaultAttrs:n.defaultAttrs,submitCallback:n.authenticate,submitText:"Login",cancelCallback:function(){return n.props.history.push("/")},cancelText:"Cancel"}))))},n.state={errorMessage:null},n.defaultAttrs={required:!0},n.formModel=[{label:"Username",attrs:{defaultValue:"admin"}},{label:"Password",attrs:{type:"password"}}],n}return a}(l.Component)));t.default=X(function(e){Object(c.a)(a,e);var t=Object(o.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).client=new s.a({uri:p.a,request:function(e){return e.setContext({headers:{Authorization:"Bearer<".concat(n.props.webToken,">")}})}}),n}return Object(n.a)(a,[{key:"render",value:function(){return i.a.createElement(u.ApolloProvider,{client:this.client},i.a.createElement("div",{className:"container-fluid"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col bg-info text-white"},i.a.createElement("div",{className:"navbar-brand"},"SPORTS STORE"))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-3 p-2"},i.a.createElement(D.a,{to:"/admin/orders"},"Orders"),i.a.createElement(D.a,{to:"/admin/products"},"Products"),this.props.isAuthenticated&&i.a.createElement("button",{onClick:this.props.signout,className:"btn btn-block btn-secondary m-2 fixed-bottom col-3"},"Log Out")),i.a.createElement("div",{className:"col p-2"},i.a.createElement(q.a,null,!this.props.isAuthenticated&&i.a.createElement(M.a,{component:Y}),i.a.createElement(M.a,{path:"/admin/orders",component:T}),i.a.createElement(M.a,{path:"/admin/products/create",component:V}),i.a.createElement(M.a,{path:"/admin/products/:id",component:G}),i.a.createElement(M.a,{path:"/admin/products/",component:F}),i.a.createElement(I.a,{to:"/admin/orders"}))))))}}]),a}(l.Component))}}]);
//# sourceMappingURL=4.7e268489.chunk.js.map